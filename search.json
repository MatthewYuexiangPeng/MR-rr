[{"path":"https://matthewyuexiangpeng.github.io/MR.rr/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2024 MR.rr Yuexiang Peng, Zhilong Zhang Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://matthewyuexiangpeng.github.io/MR.rr/articles/MR.rr.html","id":"the-usage-of-the-estimator-function","dir":"Articles","previous_headings":"","what":"The usage of the estimator function","title":"Small demo of the MR.rr package","text":"First, give example use estimator practice generated sample data.","code":"library(MR.rr) set.seed(123) # Generate the data pz = 100 # the number of SNPs px = 10 # the number of exposures py = 10 # the number of outcomes rank = 5 # the rank of the causal effect matrix C Gamma = matrix(rnorm(pz * py), pz, py) # regression coefficient matrix of outcomes on SNPs gamma = matrix(rnorm(pz * px), pz, px) # regression coefficient matrix of exposures on SNPs Sigma_X = matrix(rnorm(px * px), px, px)  Sigma_X = Sigma_X %*% t(Sigma_X) # use the average SE matrix of gamma across all SNPs in practice Sigma_Y = matrix(rnorm(py * py), py, py)  Sigma_Y = Sigma_Y %*% t(Sigma_Y) # use the average SE matrix of Gamma across all SNPs in practice  C_hat_naive = mr_rr_naive(Y=Gamma, X=gamma, r=rank, W=solve(Sigma_Y))$AB print(\"This is the estimated causal effect matrix C with rank 5 by the naive MR-rr estimator:\") #> [1] \"This is the estimated causal effect matrix C with rank 5 by the naive MR-rr estimator:\" print(C_hat_naive) #>               [,1]          [,2]        [,3]         [,4]          [,5] #>  [1,]  0.047092730 -0.1634795260  0.08176922  0.143962468  0.0877066857 #>  [2,]  0.008620659 -0.0831265385 -0.06071926 -0.056823285  0.1107032865 #>  [3,] -0.083129503 -0.0050750851 -0.09064111 -0.001882808 -0.1563634926 #>  [4,]  0.238255947 -0.0719393083  0.05890658  0.053790568  0.1147569345 #>  [5,]  0.044344026  0.0968665121  0.03025975  0.040032090 -0.0420447916 #>  [6,]  0.056512484 -0.0003290531  0.02957345  0.027461754 -0.1687938592 #>  [7,]  0.002815842  0.1895144418 -0.09303392  0.028562107 -0.0004858837 #>  [8,]  0.105159045 -0.0785223702  0.19827403  0.008092094 -0.0477872491 #>  [9,] -0.077893578 -0.0179396951  0.13715885 -0.045445425  0.0549699273 #> [10,]  0.256508760 -0.1269180241 -0.15879027  0.042333714 -0.0233843543 #>               [,6]         [,7]         [,8]         [,9]       [,10] #>  [1,]  0.111429696 -0.022720606  0.110639976  0.101277877  0.05462868 #>  [2,] -0.125931820 -0.177608200 -0.012557434 -0.009149651 -0.07611947 #>  [3,] -0.057814975  0.003372294 -0.026220515  0.028714823  0.03379240 #>  [4,]  0.129462773 -0.046218646  0.018741473 -0.004124733  0.07423671 #>  [5,]  0.094388289  0.130419748 -0.009935989 -0.016138653  0.08079067 #>  [6,]  0.118530346  0.091950693 -0.005996770  0.013991857  0.07515206 #>  [7,] -0.026962234  0.108751597 -0.062354295 -0.041615549  0.11691259 #>  [8,]  0.210420321  0.073197176  0.059572275  0.006618784 -0.03677907 #>  [9,]  0.029446431  0.026150396  0.051062980 -0.010325912 -0.14143580 #> [10,] -0.005343873 -0.178393280 -0.057345179  0.019867529  0.16748060 C_hat = mr_rr(Y=Gamma, X=gamma, r=rank, Sigma_X=Sigma_X, W=solve(Sigma_Y))$AB print(\"This is the estimated causal effect matrix C with rank 5 by the MR-rr estimator:\") #> [1] \"This is the estimated causal effect matrix C with rank 5 by the MR-rr estimator:\" print(C_hat) #>                [,1]        [,2]         [,3]         [,4]         [,5] #>  [1,] -2.443153e-05 -0.01098050  0.001571977 -0.010410645  0.004153320 #>  [2,] -1.292330e-01 -0.22422575  0.163909734 -0.366727922  0.445155319 #>  [3,] -1.636965e-02  0.04470537  0.013380929  0.005320086  0.045016525 #>  [4,] -1.183138e-02  0.02329179  0.011693258 -0.002021781  0.039543013 #>  [5,]  4.703109e-02  0.10783074 -0.063400878  0.154798903 -0.170628860 #>  [6,]  3.597779e-03 -0.11190116  0.007606195 -0.065931773  0.007525609 #>  [7,]  4.566079e-03  0.25657540 -0.035290044  0.203360787 -0.077434396 #>  [8,]  9.110504e-02  0.12876381 -0.114030901  0.243264142 -0.315937785 #>  [9,] -6.256683e-02 -0.13630580  0.083816580 -0.205936536  0.227641469 #> [10,] -2.283862e-02 -0.06343240  0.032919222 -0.092702573  0.090484120 #>               [,6]        [,7]         [,8]          [,9]       [,10] #>  [1,]  0.009123475 -0.00635172 -0.004874002  0.0037227578 -0.00299811 #>  [2,]  0.061201771 -0.18221584 -0.053374176  0.1358796376  0.15804019 #>  [3,] -0.069271101  0.02970941  0.030143310  0.0003307395  0.05739294 #>  [4,] -0.055393071  0.02137561  0.016854418  0.0064547500  0.04060412 #>  [5,] -0.057166935  0.09528793  0.033273174 -0.0609189918 -0.04167971 #>  [6,]  0.099062367 -0.06660969 -0.059618965  0.0244162244 -0.06216718 #>  [7,] -0.226885536  0.16732317  0.124279161 -0.0760565667  0.10094165 #>  [8,] -0.014683258  0.11306126  0.022472446 -0.0948267484 -0.12782601 #>  [9,]  0.065113395 -0.11616381 -0.038773624  0.0785509965  0.06470333 #> [10,]  0.035481172 -0.04943013 -0.018977953  0.0339767811  0.02313105 C_hat_r = mr_rr_regularized(Y=Gamma, X=gamma, r=rank, Sigma_X=Sigma_X,                            regularization_rate = 1e-13, W=solve(Sigma_Y))$AB print(\"This is the estimated causal effect matrix C with rank 5 by the MR-rr estimator with regularization:\") #> [1] \"This is the estimated causal effect matrix C with rank 5 by the MR-rr estimator with regularization:\" print(C_hat_r) #>                [,1]        [,2]         [,3]         [,4]         [,5] #>  [1,] -2.443153e-05 -0.01098050  0.001571977 -0.010410645  0.004153320 #>  [2,] -1.292330e-01 -0.22422575  0.163909734 -0.366727922  0.445155319 #>  [3,] -1.636965e-02  0.04470537  0.013380929  0.005320086  0.045016525 #>  [4,] -1.183138e-02  0.02329179  0.011693258 -0.002021781  0.039543013 #>  [5,]  4.703109e-02  0.10783074 -0.063400878  0.154798903 -0.170628860 #>  [6,]  3.597779e-03 -0.11190116  0.007606195 -0.065931773  0.007525609 #>  [7,]  4.566079e-03  0.25657540 -0.035290044  0.203360787 -0.077434396 #>  [8,]  9.110504e-02  0.12876381 -0.114030901  0.243264142 -0.315937785 #>  [9,] -6.256683e-02 -0.13630580  0.083816580 -0.205936536  0.227641469 #> [10,] -2.283862e-02 -0.06343240  0.032919222 -0.092702573  0.090484120 #>               [,6]        [,7]         [,8]          [,9]       [,10] #>  [1,]  0.009123475 -0.00635172 -0.004874002  0.0037227578 -0.00299811 #>  [2,]  0.061201771 -0.18221584 -0.053374176  0.1358796376  0.15804019 #>  [3,] -0.069271101  0.02970941  0.030143310  0.0003307395  0.05739294 #>  [4,] -0.055393071  0.02137561  0.016854418  0.0064547500  0.04060412 #>  [5,] -0.057166935  0.09528793  0.033273174 -0.0609189918 -0.04167971 #>  [6,]  0.099062367 -0.06660969 -0.059618965  0.0244162244 -0.06216718 #>  [7,] -0.226885536  0.16732317  0.124279161 -0.0760565667  0.10094165 #>  [8,] -0.014683258  0.11306126  0.022472446 -0.0948267484 -0.12782601 #>  [9,]  0.065113395 -0.11616381 -0.038773624  0.0785509965  0.06470333 #> [10,]  0.035481172 -0.04943013 -0.018977953  0.0339767811  0.02313105"},{"path":"https://matthewyuexiangpeng.github.io/MR.rr/articles/MR.rr.html","id":"the-usage-of-the-run_simulation-function","dir":"Articles","previous_headings":"","what":"The usage of the run_simulation function","title":"Small demo of the MR.rr package","text":", illustrate use simulation function package access performance MR-rr estimator near realistic data. generate reasonable simulated data, use GWAS-Lipid data incorporated package generate true parameters rank 5 causal effect matrix C 24 dimension exposures 10 dimension outcomes. simulate data true parameters run naive MR-rr estimator MR-rr estimator regularization compare performance respect true C. rough glance, can see MR-rr estimator regularization smaller bias naive MR-rr estimator. can also visualize results plotting boxplots bias heatmaps bias standard deviation following functions.","code":"sim_result = run_simulation(regularized = TRUE, regularization_rate = 1e-13) bias_naive_MRrr = sim_result[[1]] bias_MRrr_regularized = sim_result[[2]] print(\"This is a demo of the output format of the run_simulation function:\") #> [1] \"This is a demo of the output format of the run_simulation function:\" str(bias_naive_MRrr) #> List of 5 #>  $ 1   : num [1:240, 1:100] -1.088 -1.123 0.587 -1.93 2.225 ... #>  $ 0.5 : num [1:240, 1:100] 0.0991 0.4033 0.5259 0.2762 -0.3399 ... #>  $ 0.2 : num [1:240, 1:100] 0.0486 0.3397 0.9793 0.4412 -0.067 ... #>  $ 0.1 : num [1:240, 1:100] 0.0675 0.1477 -0.1559 -0.4915 -0.2613 ... #>  $ 0.05: num [1:240, 1:100] 0.2732 -0.1623 -0.429 -0.0717 0.1762 ... print(\"This is a summary of the entrywise bias of the naive MR-rr estimator:\") #> [1] \"This is a summary of the entrywise bias of the naive MR-rr estimator:\" summary(unlist(bias_naive_MRrr)) #>       Min.    1st Qu.     Median       Mean    3rd Qu.       Max.  #> -16.395973  -0.287819   0.001459   0.003567   0.284491  16.665919 print(\"This is a summary of the entrywise bias of the MR-rr estimator with regularization:\") #> [1] \"This is a summary of the entrywise bias of the MR-rr estimator with regularization:\" summary(unlist(bias_MRrr_regularized)) #>       Min.    1st Qu.     Median       Mean    3rd Qu.       Max.  #> -10.831404  -0.202926  -0.000002  -0.000607   0.200623   9.253646"},{"path":"https://matthewyuexiangpeng.github.io/MR.rr/articles/MR.rr.html","id":"the-usage-of-the-plot_boxplot-function","dir":"Articles","previous_headings":"","what":"The usage of the plot_boxplot function","title":"Small demo of the MR.rr package","text":"boxplots function takes bias matrices naive MR-rr estimator MR-rr estimator regularization input plots boxplot entry-wise bias causal effect matrix C.     boxplot, can see MR-rr estimator regularization smaller bias naive MR-rr estimator. , use heatmap visualize bias standard deviation entry estimator comapring causal effect C.","code":"plot_boxplot(bias_naive_MRrr, bias_MRrr_regularized, weight_to_plot = \"0.2\",              individual_plot = TRUE, rank_by = \"bias\") #> [[1]] #> [[1]]$`(3, 4)` #>  #> [[1]]$`(3, 7)` #>  #>  #> [[2]] #> [[2]]$`(4, 7)` #>  #> [[2]]$`(4, 4)`"},{"path":"https://matthewyuexiangpeng.github.io/MR.rr/articles/MR.rr.html","id":"the-usage-of-the-plot_heatmap-function","dir":"Articles","previous_headings":"","what":"The usage of the plot_heatmap function","title":"Small demo of the MR.rr package","text":"see IV strength 1.5, MR-rr estimator regularization smaller bias similar standard deviation comparing naive MR-rr estimator.","code":"plot_heatmap(bias_naive_MRrr, bias_MRrr_regularized, weight_to_plot = \"0.2\") #> $iv_strength #> [1] 1.596501 #>  #> $mean_abs_C_entry #> [1] 0.976197 #>  #> $mean_abs_bias_naive #> [1] 0.4948786 #>  #> $mean_abs_bias #> [1] 0.1135194 #>  #> $mean_sd_naive #> [1] 0.3057215 #>  #> $mean_sd #> [1] 0.3712203"},{"path":"https://matthewyuexiangpeng.github.io/MR.rr/articles/MR.rr.html","id":"the-usage-of-the-nonpara_bootstrap-function","dir":"Articles","previous_headings":"","what":"The usage of the nonpara_bootstrap function","title":"Small demo of the MR.rr package","text":"Finally, test whether bootstrap 95 percent confidence interval covers true causal effect matrix C 95% probability.","code":"print(\"The bootstrap coverage rate is:\") #> [1] \"The bootstrap coverage rate is:\" nonpara_bootstrap(me_weight = 1, regularized = TRUE, regularization_rate = 1e-13) #> [1] 0.93775"},{"path":"https://matthewyuexiangpeng.github.io/MR.rr/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Yuexiang Peng. Author, maintainer. Zhilong Zhang. Author.","code":""},{"path":"https://matthewyuexiangpeng.github.io/MR.rr/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Peng Y, Zhang Z (2024). MR.rr: package computing MR-rr estimator performing simulations. R package version 0.9.1, https://matthewyuexiangpeng.github.io/MR.rr/.","code":"@Manual{,   title = {MR.rr: A package for computing the MR-rr estimator and performing simulations},   author = {Yuexiang Peng and Zhilong Zhang},   year = {2024},   note = {R package version 0.9.1},   url = {https://matthewyuexiangpeng.github.io/MR.rr/}, }"},{"path":"https://matthewyuexiangpeng.github.io/MR.rr/index.html","id":"purpose","dir":"","previous_headings":"","what":"A package for computing the MR-rr estimator and performing simulations","title":"A package for computing the MR-rr estimator and performing simulations","text":"package MR-rr Yuexiang Peng (author, maintainer) Zhilong Zhang (author). URL GitHub (.e., source code) : https://github.com/MatthewYuexiangPeng/MR.rr URL Pkgdown webpage : https://matthewyuexiangpeng.github.io/MR.rr/","code":""},{"path":"https://matthewyuexiangpeng.github.io/MR.rr/index.html","id":"how-to-install","dir":"","previous_headings":"","what":"How to install","title":"A package for computing the MR-rr estimator and performing simulations","text":"package called MR.rr. install, run following code (R): Upon completion, can run following code (R):","code":"library(devtools) devtools::install_github(\"MatthewYuexiangPeng/MR.rr\") library(MR.rr\")"},{"path":"https://matthewyuexiangpeng.github.io/MR.rr/index.html","id":"dependencies","dir":"","previous_headings":"","what":"Dependencies","title":"A package for computing the MR-rr estimator and performing simulations","text":"package depends following packages: MASS, ggplot2, patchwork, pheatmap.","code":""},{"path":"https://matthewyuexiangpeng.github.io/MR.rr/index.html","id":"session-info","dir":"","previous_headings":"","what":"Session info","title":"A package for computing the MR-rr estimator and performing simulations","text":"package developed following environment","code":"> devtools::session_info() ─ Session info ───────────────────────────────────────────────────────────────────────────────────────────  setting  value  version  R version 4.3.1 (2023-06-16 ucrt)  os       Windows 11 x64 (build 22631)  system   x86_64, mingw32  ui       RStudio  language (EN)  collate  Chinese (Simplified)_China.utf8  ctype    Chinese (Simplified)_China.utf8  tz       America/Los_Angeles  date     2024-11-18  rstudio  2023.09.0+463 Desert Sunflower (desktop)  pandoc   3.1.1 @ C:/Program Files/RStudio/resources/app/bin/quarto/bin/tools/ (via rmarkdown)  ─ Packages ───────────────────────────────────────────────────────────────────────────────────────────────  ! package      * version    date (UTC) lib source    askpass        1.2.0      2023-09-03 [1] CRAN (R 4.3.2)    brio           1.1.4      2023-12-10 [1] CRAN (R 4.3.2)    cachem         1.0.8      2023-05-01 [1] CRAN (R 4.3.2)    callr          3.7.5      2024-02-19 [1] CRAN (R 4.3.2)    cli            3.6.2      2023-12-11 [1] CRAN (R 4.3.2)    colorspace     2.1-0      2023-01-23 [1] CRAN (R 4.3.2)    commonmark     1.9.0      2023-03-17 [1] CRAN (R 4.3.2)    credentials    2.0.1      2023-09-06 [1] CRAN (R 4.3.2)    curl           6.0.0      2024-11-05 [1] CRAN (R 4.3.3)    desc           1.4.3      2023-12-10 [1] CRAN (R 4.3.2)    devtools       2.4.5      2022-10-11 [1] CRAN (R 4.3.3)    digest         0.6.34     2024-01-11 [1] CRAN (R 4.3.2)    dplyr          1.1.4      2023-11-17 [1] CRAN (R 4.3.2)    ellipsis       0.3.2      2021-04-29 [1] CRAN (R 4.3.2)    evaluate       1.0.1      2024-10-10 [1] CRAN (R 4.3.3)    fansi          1.0.6      2023-12-08 [1] CRAN (R 4.3.2)    fastmap        1.1.1      2023-02-24 [1] CRAN (R 4.3.2)    fs             1.6.3      2023-07-20 [1] CRAN (R 4.3.2)    generics       0.1.3      2022-07-05 [1] CRAN (R 4.3.2)    gert           2.0.1      2023-12-04 [1] CRAN (R 4.3.2)  V ggplot2        3.4.4      2024-04-23 [1] CRAN (R 4.3.3) (on disk 3.5.1)    gh             1.4.0      2023-02-22 [1] CRAN (R 4.3.2)    gitcreds       0.1.2      2022-09-08 [1] CRAN (R 4.3.2)    glue           1.7.0      2024-01-09 [1] CRAN (R 4.3.2)  V gtable         0.3.4      2024-10-25 [1] CRAN (R 4.3.3) (on disk 0.3.6)    htmltools      0.5.8.1    2024-04-04 [1] CRAN (R 4.3.3)    htmlwidgets    1.6.4      2023-12-06 [1] CRAN (R 4.3.2)    httpuv         1.6.14     2024-01-26 [1] CRAN (R 4.3.2)    httr2          1.0.6      2024-11-04 [1] CRAN (R 4.3.3)    jsonlite       1.8.9      2024-09-20 [1] CRAN (R 4.3.3)    knitr          1.49       2024-11-08 [1] CRAN (R 4.3.3)    later          1.3.2      2023-12-06 [1] CRAN (R 4.3.2)    lifecycle      1.0.4      2023-11-07 [1] CRAN (R 4.3.2)    magrittr       2.0.3      2022-03-30 [1] CRAN (R 4.3.2)    MASS           7.3-60.0.1 2024-01-13 [1] CRAN (R 4.3.3)    memoise        2.0.1      2021-11-26 [1] CRAN (R 4.3.2)    mime           0.12       2021-09-28 [1] CRAN (R 4.3.1)    miniUI         0.1.1.1    2018-05-18 [1] CRAN (R 4.3.2)    MR.rr        * 0.0.0.9000 2024-11-18 [1] local  V munsell        0.5.0      2024-04-01 [1] CRAN (R 4.3.3) (on disk 0.5.1)    openssl        2.1.1      2023-09-25 [1] CRAN (R 4.3.2)  V patchwork      1.2.0      2024-09-16 [1] CRAN (R 4.3.3) (on disk 1.3.0)    pheatmap       1.0.12     2019-01-04 [1] CRAN (R 4.3.3)    pillar         1.9.0      2023-03-22 [1] CRAN (R 4.3.2)    pkgbuild       1.4.3      2023-12-10 [1] CRAN (R 4.3.2)    pkgconfig      2.0.3      2019-09-22 [1] CRAN (R 4.3.2)    pkgdown        2.1.1      2024-09-17 [1] CRAN (R 4.3.3)    pkgload        1.3.4      2024-01-16 [1] CRAN (R 4.3.2)    prettyunits    1.2.0      2023-09-24 [1] CRAN (R 4.3.2)    processx       3.8.3      2023-12-10 [1] CRAN (R 4.3.2)    profvis        0.3.8      2023-05-02 [1] CRAN (R 4.3.2)    promises       1.2.1      2023-08-10 [1] CRAN (R 4.3.2)    ps             1.7.6      2024-01-18 [1] CRAN (R 4.3.2)    purrr          1.0.2      2023-08-10 [1] CRAN (R 4.3.3)    R6             2.5.1      2021-08-19 [1] CRAN (R 4.3.2)    rappdirs       0.3.3      2021-01-31 [1] CRAN (R 4.3.2)    rcmdcheck      1.4.0      2021-09-27 [1] CRAN (R 4.3.2)    RColorBrewer   1.1-3      2022-04-03 [1] CRAN (R 4.3.1)    Rcpp           1.0.12     2024-01-09 [1] CRAN (R 4.3.2)    remotes        2.4.2.1    2023-07-18 [1] CRAN (R 4.3.2)    rlang          1.1.3      2024-01-10 [1] CRAN (R 4.3.2)    rmarkdown      2.29       2024-11-04 [1] CRAN (R 4.3.3)    roxygen2       7.3.1      2024-01-22 [1] CRAN (R 4.3.2)    rprojroot      2.0.4      2023-11-05 [1] CRAN (R 4.3.2)    rstudioapi     0.15.0     2023-07-07 [1] CRAN (R 4.3.2)    scales         1.3.0      2023-11-28 [1] CRAN (R 4.3.2)    sessioninfo    1.2.2      2021-12-06 [1] CRAN (R 4.3.2)    shiny          1.8.0      2023-11-17 [1] CRAN (R 4.3.2)    stringi        1.8.3      2023-12-11 [1] CRAN (R 4.3.2)    stringr        1.5.1      2023-11-14 [1] CRAN (R 4.3.2)    sys            3.4.2      2023-05-23 [1] CRAN (R 4.3.2)    testthat       3.2.1      2023-12-02 [1] CRAN (R 4.3.2)    tibble         3.2.1      2023-03-20 [1] CRAN (R 4.3.2)    tidyselect     1.2.0      2022-10-10 [1] CRAN (R 4.3.2)    urlchecker     1.0.1      2021-11-30 [1] CRAN (R 4.3.2)    usethis        3.0.0      2024-07-29 [1] CRAN (R 4.3.3)    utf8           1.2.4      2023-10-22 [1] CRAN (R 4.3.2)    vctrs          0.6.5      2023-12-01 [1] CRAN (R 4.3.2)  V withr          3.0.0      2024-10-28 [1] CRAN (R 4.3.3) (on disk 3.0.2)    xfun           0.49       2024-10-31 [1] CRAN (R 4.3.3)    xml2           1.3.6      2023-12-04 [1] CRAN (R 4.3.2)    xopen          1.0.0      2018-09-17 [1] CRAN (R 4.3.2)    xtable         1.8-4      2019-04-21 [1] CRAN (R 4.3.2)    yaml           2.3.8      2023-12-11 [1] CRAN (R 4.3.2)   [1] C:/Users/Yuexiang Peng/AppData/Local/R/win-library/4.3  [2] C:/Program Files/R/R-4.3.1/library   V ── Loaded and on-disk version mismatch.  ──────────────────────────────────────────────────────────────────────────────────────────────────────────"},{"path":"https://matthewyuexiangpeng.github.io/MR.rr/reference/mr_rr.html","id":null,"dir":"Reference","previous_headings":"","what":"MR-rr estimator — mr_rr","title":"MR-rr estimator — mr_rr","text":"MR-rr estimator","code":""},{"path":"https://matthewyuexiangpeng.github.io/MR.rr/reference/mr_rr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"MR-rr estimator — mr_rr","text":"","code":"mr_rr(Y, X, r, Sigma_X, W = NULL, W_inv = NULL)"},{"path":"https://matthewyuexiangpeng.github.io/MR.rr/reference/mr_rr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"MR-rr estimator — mr_rr","text":"Y n py numeric matrix, n number SNPs py number outcomes. argument corresponds \\(\\Gamma^T\\) manuscript. X n px numeric matrix, n number SNPs px number exposures. argument corresponds \\(\\gamma^T\\) manuscript. r integer, indicating rank causal effect matrix C desire estimate. Sigma_X px px numeric matrix, average conditional covariance matrix coefficients regressing exposures SNPs, can culculated averaging regression SEs across SNPs. corresponds \\(\\Sigma_X\\) manuscript, see details estimator section manuscript. W py py numeric matrix, weight matrix used reduced rank regression method. recommended set inverse covariance matrix outcomes. provided, assumed identity matrix. corresponds \\(W^{\\frac{1}{2}}\\) manuscript. W_inv inverse W","code":""},{"path":"https://matthewyuexiangpeng.github.io/MR.rr/reference/mr_rr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"MR-rr estimator — mr_rr","text":"list three matrices: , B, AB. py r matrix, B r px matrix, AB py px matrix. matrix B B identified MR-rr estimator, product AB estimated causal effect matrix C exposures outcomes MR-rr estimator. See details manuscript.","code":""},{"path":"https://matthewyuexiangpeng.github.io/MR.rr/reference/mr_rr_naive.html","id":null,"dir":"Reference","previous_headings":"","what":"Naive MR-rr estimator — mr_rr_naive","title":"Naive MR-rr estimator — mr_rr_naive","text":"Naive MR-rr estimator","code":""},{"path":"https://matthewyuexiangpeng.github.io/MR.rr/reference/mr_rr_naive.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Naive MR-rr estimator — mr_rr_naive","text":"","code":"mr_rr_naive(Y, X, r, W = NULL, W_inv = NULL)"},{"path":"https://matthewyuexiangpeng.github.io/MR.rr/reference/mr_rr_naive.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Naive MR-rr estimator — mr_rr_naive","text":"Y n py numeric matrix, n number SNPs py number outcomes. argument corresponds \\(\\Gamma^T\\) manuscript. X n px numeric matrix, n number SNPs px number exposures. argument corresponds \\(\\gamma^T\\) manuscript. r integer, indicating rank causal effect matrix C desire estimate. W py py numeric matrix, weight matrix used reduced rank regression method. recommended set inverse covariance matrix outcomes. provided, assumed identity matrix. corresponds \\(W^{\\frac{1}{2}}\\) manuscript. W_inv inverse W","code":""},{"path":"https://matthewyuexiangpeng.github.io/MR.rr/reference/mr_rr_naive.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Naive MR-rr estimator — mr_rr_naive","text":"list three matrices: , B, AB. py r matrix, B r px matrix, AB py px matrix. matrix B B identified naive MR-rr estimator, product AB estimated causal effect matrix C exposures outcomes naive MR-rr estimator. See details manuscript.","code":""},{"path":"https://matthewyuexiangpeng.github.io/MR.rr/reference/mr_rr_regularized.html","id":null,"dir":"Reference","previous_headings":"","what":"MR-rr estimator with spectral regularization — mr_rr_regularized","title":"MR-rr estimator with spectral regularization — mr_rr_regularized","text":"MR-rr estimator spectral regularization","code":""},{"path":"https://matthewyuexiangpeng.github.io/MR.rr/reference/mr_rr_regularized.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"MR-rr estimator with spectral regularization — mr_rr_regularized","text":"","code":"mr_rr_regularized(   Y,   X,   r,   Sigma_X,   regularization_rate = 1e-13,   W = NULL,   W_inv = NULL )"},{"path":"https://matthewyuexiangpeng.github.io/MR.rr/reference/mr_rr_regularized.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"MR-rr estimator with spectral regularization — mr_rr_regularized","text":"Y n py numeric matrix, n number SNPs py number outcomes. argument corresponds \\(\\Gamma^T\\) manuscript. X n px numeric matrix, n number SNPs px number exposures. argument corresponds \\(\\gamma^T\\) manuscript. r integer, indicating rank causal effect matrix C desire estimate. Sigma_X px px numeric matrix, average conditional covariance matrix coefficients regressing exposures SNPs, can culculated averaging regression SEs across SNPs. corresponds \\(\\Sigma_X\\) manuscript, see details estimator section manuscript. regularization_rate numeric value, regularization rate used MR-rr estimator spectral regularization. corresponds \\(\\phi\\) manuscript, see details estimator section manuscript. W py py numeric matrix, weight matrix used reduced rank regression method. recommended set inverse covariance matrix outcomes. provided, assumed identity matrix. corresponds \\(W^{\\frac{1}{2}}\\) manuscript. W_inv inverse W","code":""},{"path":"https://matthewyuexiangpeng.github.io/MR.rr/reference/mr_rr_regularized.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"MR-rr estimator with spectral regularization — mr_rr_regularized","text":"list three matrices: , B, AB. py r matrix, B r px matrix, AB py px matrix. matrix B B identified MR-rr estimator spectral regularization, product AB estimated causal effect matrix C exposures outcomes MR-rr estimator spectral regularization. See details manuscript.","code":""},{"path":"https://matthewyuexiangpeng.github.io/MR.rr/reference/nonpara_bootstrap.html","id":null,"dir":"Reference","previous_headings":"","what":"Non-parametric bootstrap method to estimate variance of the Drr estimator — nonpara_bootstrap","title":"Non-parametric bootstrap method to estimate variance of the Drr estimator — nonpara_bootstrap","text":"Non-parametric bootstrap method estimate variance Drr estimator","code":""},{"path":"https://matthewyuexiangpeng.github.io/MR.rr/reference/nonpara_bootstrap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Non-parametric bootstrap method to estimate variance of the Drr estimator — nonpara_bootstrap","text":"","code":"nonpara_bootstrap(   me_weight = 0.2,   regularized = TRUE,   regularization_rate = 1e-13 )"},{"path":"https://matthewyuexiangpeng.github.io/MR.rr/reference/nonpara_bootstrap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Non-parametric bootstrap method to estimate variance of the Drr estimator — nonpara_bootstrap","text":"me_weight character value positive number, recommend chosen 0.05 1. argument indicates measurement error weight, means scaler multiply measurement error coefficients exposure SNPs, \\(\\Sigma_X\\) manuscript. Smaller measurement error weight implies larger IV strength. regularized can TRUE FALSE, indicating whether use MR-rr estiomator spectral regularization. See manuscript details. regularization_rate small positive numerical value, indicating regularization rate. used regularized = TRUE. larger regularization_rate make estimator smaller variance, rate can large ensure consistency holds, see details manuscript.","code":""},{"path":"https://matthewyuexiangpeng.github.io/MR.rr/reference/nonpara_bootstrap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Non-parametric bootstrap method to estimate variance of the Drr estimator — nonpara_bootstrap","text":"average coverage rate entry-wise 95% confidence interval produced non-parametric bootstrap method.","code":""},{"path":"https://matthewyuexiangpeng.github.io/MR.rr/reference/plot_boxplot.html","id":null,"dir":"Reference","previous_headings":"","what":"The function to create the boxplot for the bias of the naive MR-rr estimator and the MR-rr estimator (with spectral regularization) comparing to true C for each entry. — plot_boxplot","title":"The function to create the boxplot for the bias of the naive MR-rr estimator and the MR-rr estimator (with spectral regularization) comparing to true C for each entry. — plot_boxplot","text":"function create boxplot bias naive MR-rr estimator MR-rr estimator (spectral regularization) comparing true C entry.","code":""},{"path":"https://matthewyuexiangpeng.github.io/MR.rr/reference/plot_boxplot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The function to create the boxplot for the bias of the naive MR-rr estimator and the MR-rr estimator (with spectral regularization) comparing to true C for each entry. — plot_boxplot","text":"","code":"plot_boxplot(   result_AB_list,   result_AB_d_list,   weight_to_plot,   individual_plot = FALSE,   rank_by = \"bias\" )"},{"path":"https://matthewyuexiangpeng.github.io/MR.rr/reference/plot_boxplot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"The function to create the boxplot for the bias of the naive MR-rr estimator and the MR-rr estimator (with spectral regularization) comparing to true C for each entry. — plot_boxplot","text":"result_AB_list numerical list simulated bias naive MR-rr estimator comparing true C entry. first output function \"run_simulation\". result_AB_d_list numerical list bias simulated MR-rr estimator comparing true C entry. second output function \"run_simulation\". weight_to_plot character value can chosen \"1\", \"0.5\", \"0.2\", \"0.1\", \"0.05\", indicating plot want make measurement error weight. weight means scaler multiply measurement error coefficients exposure SNPs, \\(\\Sigma_X\\) manuscript. Smaller measurement error weight implies larger IV strength. individual_plot logical value TRUE FALSE. TRUE indicates plot boxplot entries C separately. FALSE indicates crate combined plot including estimators entries C. Default FALSE. rank_by character value can chosen \"bias\" \"sd\". indicates criteria use rank entries plot. \"bias\" means rank entries average bias estimator, \"sd\" means rank entries average standard deviation. Default \"bias\".","code":""},{"path":"https://matthewyuexiangpeng.github.io/MR.rr/reference/plot_boxplot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"The function to create the boxplot for the bias of the naive MR-rr estimator and the MR-rr estimator (with spectral regularization) comparing to true C for each entry. — plot_boxplot","text":"list boxplot entries largest bias standard deviation naive MR-rr estimator MR-rr estimator. Return either combined plot 5 entries 4 separately plots depend input \"individual_plot\".","code":""},{"path":"https://matthewyuexiangpeng.github.io/MR.rr/reference/plot_heatmap.html","id":null,"dir":"Reference","previous_headings":"","what":"The function to generate the heatmap of the average absolute bias and the standard deviation of the naive MR-rr estimator and the MR-rr estimator (with spectral regularization). — plot_heatmap","title":"The function to generate the heatmap of the average absolute bias and the standard deviation of the naive MR-rr estimator and the MR-rr estimator (with spectral regularization). — plot_heatmap","text":"function generate heatmap average absolute bias standard deviation naive MR-rr estimator MR-rr estimator (spectral regularization).","code":""},{"path":"https://matthewyuexiangpeng.github.io/MR.rr/reference/plot_heatmap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The function to generate the heatmap of the average absolute bias and the standard deviation of the naive MR-rr estimator and the MR-rr estimator (with spectral regularization). — plot_heatmap","text":"","code":"plot_heatmap(result_AB_list, result_AB_d_list, weight_to_plot)"},{"path":"https://matthewyuexiangpeng.github.io/MR.rr/reference/plot_heatmap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"The function to generate the heatmap of the average absolute bias and the standard deviation of the naive MR-rr estimator and the MR-rr estimator (with spectral regularization). — plot_heatmap","text":"result_AB_list numerical list simulated bias naive MR-rr estimator comparing true C entry. first output function \"run_simulation\". result_AB_d_list numerical list bias simulated MR-rr estimator comparing true C entry. second output function \"run_simulation\". weight_to_plot character value can chosen \"1\", \"0.5\", \"0.2\", \"0.1\", \"0.05\", indicating plot want make measurement error weight. weight means scaler multiply measurement error coefficients exposure SNPs, \\(\\Sigma_X\\) manuscript. Smaller measurement error weight implies larger IV strength.","code":""},{"path":"https://matthewyuexiangpeng.github.io/MR.rr/reference/plot_heatmap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"The function to generate the heatmap of the average absolute bias and the standard deviation of the naive MR-rr estimator and the MR-rr estimator (with spectral regularization). — plot_heatmap","text":"four heatmaps containing entry-wise average absolute bias standard deviation naive MR-rr estimator MR-rr estimator, numeric values including IV strength measurement error weight, mean absolute value entries C, average absolute bias naive MR-rr estimator MR-rr estimator, standard deviation naive MR-rr estimator MR-rr estimator.","code":""},{"path":"https://matthewyuexiangpeng.github.io/MR.rr/reference/run_simulation.html","id":null,"dir":"Reference","previous_headings":"","what":"The simulation function for the naive MR-rr estimator and the MR-rr estimator (with spectral regularization) — run_simulation","title":"The simulation function for the naive MR-rr estimator and the MR-rr estimator (with spectral regularization) — run_simulation","text":"simulation function naive MR-rr estimator MR-rr estimator (spectral regularization)","code":""},{"path":"https://matthewyuexiangpeng.github.io/MR.rr/reference/run_simulation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The simulation function for the naive MR-rr estimator and the MR-rr estimator (with spectral regularization) — run_simulation","text":"","code":"run_simulation(regularized = TRUE, regularization_rate = 1e-13)"},{"path":"https://matthewyuexiangpeng.github.io/MR.rr/reference/run_simulation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"The simulation function for the naive MR-rr estimator and the MR-rr estimator (with spectral regularization) — run_simulation","text":"regularized can TRUE FALSE, indicating whether use MR-rr estiomator spectral regularization. See manuscript details. regularization_rate small positive numerical value, indicating regularization rate. used regularized = TRUE. larger regularization_rate make estimator smaller variance, rate can large ensure consistency holds, see details manuscript.","code":""},{"path":"https://matthewyuexiangpeng.github.io/MR.rr/reference/run_simulation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"The simulation function for the naive MR-rr estimator and the MR-rr estimator (with spectral regularization) — run_simulation","text":"nested list two list element simulation results, first list contains bias naive MR-rr estimator comparing true C entry; second list contains bias MR-rr estimator comparing true C entry. either bias list, list 5 list elements, corresponding measurement error weights (see description \"plot_boxplot\" function) 1, 0.5, 0.2, 0.1, 0.05. element 240 100, number entries iteration simulation.","code":""}]
